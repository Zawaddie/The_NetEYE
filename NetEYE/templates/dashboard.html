{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="shortcut icon" href="{% static 'images/NETEYE2.PNG' %}" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Network Monitoring Dashboard</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        .navbar-nav .nav-link {
            font-size: 25px;
            font-weight: bold;

        }
        body {
            padding: 0px;
        }

        canvas {
            max-width: 600px; /* Adjust the maximum width of the chart as needed */
            margin-bottom: 20px;
        }

        .live-data-table {
            width: 100%;
            margin-top: 20px;
        }

        footer {
            margin-top: 20px;
            background-color: #f8f9fa;
            padding: 10px 0;
            text-align: center;
        }
        .custom-navbar {
        background-color:peachpuff;
    }
    * Example CSS for shadow effect */
.feature-column {
    box-shadow: 0 4px 8px rgba(6, 56, 1, 0.1); /* Adjust the values as needed */
    transition: box-shadow 0.3s ease-in-out;
}

.feature-column:hover {
    box-shadow: 0 8px 16px rgba(32, 177, 27, 0.2); /* Adjust the values as needed */
}
    </style>
</head>
<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light custom-navbar">
        <div class="container">
            <a class="navbar-brand" href="#">
            <img src="{% static 'images/FINAL.png' %}" alt="Your Logo" height="100" class="d-inline-block align-text-top">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item me-4">
                        <a class="nav-link" href="{% url 'index' %}">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link me-4" href="{% url 'dashboard' %}">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link me-4" href="{% url 'features' %}">Features</a>
                   </li>
                     <li class="nav-item me-3">
                        <a class="nav-link" target="_blank"  href="https://youtu.be/cze94MRjrrE?si=mCJUF1NBC4JWAuv2">How to Use</a>
                    </li>
                    <!-- <li class="nav-item me-3">
                        <a class="nav-link" href="">Settings</a>
                    </li> -->
                    <li class="nav-item me-3">
                        <a class="nav-link" href="{% url 'subscription' %}">Premium</a>
                    </li>
                {% if request.user.is_authenticated %}
                <li class="nav-item ms-auto">
                    <a class="btn btn-success" href="{% url 'logout' %}">Logout</a>
                </li>
                {% else %}
                <li class="nav-item ms-auto">
                    <a class="btn btn-success" href="{% url 'login' %}">Login</a>
                </li>
                {% endif %}
                </ul>
            </div>
        </div>
    </nav>

      <div class="messages">
    {% if messages %}
    <ul class=" messages">
        {%  for ms in messages %}
        <li  {% if ms.tag %} class="{{ms.tag}} text text-danger alert" {% endif %}>{{ms}}</li>
        {% endfor %}
    </ul>

    {% endif %}

    </div>

    <!-- Content -->
    <div class="row">
        <!-- File Upload Button and Start Packet Capture Button -->
        <div class="col-md-6 feature-column p-5">
            <form action="" class="myform" enctype="multipart/form-data" method="post">
                {% csrf_token %}
                <button type="button" class="btn btn-danger mb-3">Start Live Packet Capture</button>
                <div class="mb-3">
                    <label for="fileInput" class="form-label"> You can also Upload your saved PCAP File:</label>
                    <input type="file" class="form-control" id="fileInput" name="packets">
                </div>

                <button type="submit" class="btn btn-success btn-block">Upload</button>
        </form>

        </div>

        <!-- Chart -->
        <div class="col-md-6 feature-column  p-5">
            <h2>Attack Chart</h2>
            <canvas id="attackChart"></canvas>
        </div>
    </div>

    <!-- Live Data Table -->
<div class="live-data-table feature-column">
    <h2>Live Data</h2>
    {% if table %}
    {{ table|safe  }}
    {% else %}
    No Table
    {% endif %}
    <table class="table table-bordered feature-column ">
        <thead>
            <tr>
                <th>Packet Ref. No.</th>
                <th>Src IP</th>
                <th>Dest IP</th>
                <th>Timestamp</th>
                <th>Classification</th>
            </tr>
        </thead>
        <tbody>
            <!-- Example rows, replace with actual data from your application -->
            <tr>
                <td>001</td>
                <td>192.168.1.1</td>
                <td>10.0.0.1</td>
                <td>2023-11-15 12:30:45</td>
                <td>Benign</td>
            </tr>
            <tr>
                <td>002</td>
                <td>192.168.1.2</td>
                <td>10.0.0.2</td>
                <td>2023-11-15 12:31:15</td>
                <td>Malicious</td>
            </tr>
            <!-- Add more rows as needed -->
        </tbody>
        <!-- Table rows will be dynamically added with JavaScript -->
    </table>
</div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p>&copy; 2023 ENGraced Tech Solutions. All rights reserved.</p>
            {{preds}}
        </div>
    </footer>

    <!-- JavaScript for Chart and Live Data -->
    <script>
        // Sample data for the chart
        var curr_data = JSON.parse('{{  chart_data|escapejs }}')
        var chartData = {
            labels: curr_data.names, //['Attack 1', 'Attack 2', 'Attack 3', 'Attack 4', 'Attack 5'],
            datasets: [{
                label: 'Number of Attacks',
                data: curr_data.data,
                backgroundColor: ['rgba(75, 192, 192, 0.6)', 'rgba(255, 99, 132, 0.6)', 'rgba(255, 205, 86, 0.6)', 'rgba(54, 162, 235, 0.6)', 'rgba(153, 102, 255, 0.6)'],
                borderColor: ['rgba(75, 192, 192, 1)', 'rgba(255, 99, 132, 1)', 'rgba(255, 205, 86, 1)', 'rgba(54, 162, 235, 1)', 'rgba(153, 102, 255, 1)'],
                borderWidth: 1
            }]
        };

        // Chart.js configuration
        var ctx = document.getElementById('attackChart').getContext('2d');
        var attackChart = new Chart(ctx, {
            type: 'bar',
            data: chartData,
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // Sample function to add rows to the live data table
        function addRowToTable(details, classification) {
            var tableBody = document.querySelector('.live-data-table tbody');
            var newRow = tableBody.insertRow();
            var cell1 = newRow.insertCell(0);
            var cell2 = newRow.insertCell(1);
            cell1.innerHTML = details;
            cell2.innerHTML = classification;
        }

        // Sample usage of the addRowToTable function
        addRowToTable('Packet 1 details', 'Benign');
        addRowToTable('Packet 2 details', 'Malicious');
        // Add more rows as needed...
    </script>

    <!-- Bootstrap JS and Popper.js (required for some Bootstrap components) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
